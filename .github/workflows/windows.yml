
name: Windows

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  build:
    name: Build
    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v3

    - name: Download SDL2
      run: |
        Invoke-WebRequest -Uri 'https://github.com/libsdl-org/SDL/releases/download/release-2.28.5/SDL2-devel-2.28.5-VC.zip' -OutFile 'SDL2-devel-2.28.5-VC.zip'
        Expand-Archive -Path 'SDL2-devel-2.28.5-VC.zip' -DestinationPath SDL2

    - name: Build
      run: |
        cmake -B build -A x64 -DCMAKE_PREFIX_PATH="SDL2/SDL2-2.28.5"
        cmake --build build --config Release

    - uses: actions/upload-artifact@v3
      with:
        name: snakespasm-win64
        path: build/Release/snakespasm.exe

